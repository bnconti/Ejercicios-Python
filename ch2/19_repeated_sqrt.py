# Exercise 2.19: Explore round-off errors from a large number of inverse operations

"""
SAMPLE RUN:
1 times sqrt and **2: 2.0000000000000004
2 times sqrt and **2: 1.9999999999999996
3 times sqrt and **2: 1.9999999999999996
4 times sqrt and **2: 1.9999999999999964
5 times sqrt and **2: 1.9999999999999964
6 times sqrt and **2: 1.9999999999999964
7 times sqrt and **2: 1.9999999999999714
8 times sqrt and **2: 2.0000000000000235
9 times sqrt and **2: 2.0000000000000235
10 times sqrt and **2: 2.0000000000000235
11 times sqrt and **2: 2.0000000000000235
12 times sqrt and **2: 1.9999999999991336
13 times sqrt and **2: 1.9999999999973292
14 times sqrt and **2: 1.9999999999973292
15 times sqrt and **2: 1.9999999999973292
16 times sqrt and **2: 2.0000000000117746
17 times sqrt and **2: 2.0000000000408580
18 times sqrt and **2: 2.0000000000408580
19 times sqrt and **2: 2.0000000001573586
20 times sqrt and **2: 2.0000000001573586
21 times sqrt and **2: 2.0000000001573586
22 times sqrt and **2: 2.0000000010885857
23 times sqrt and **2: 2.0000000029511749
24 times sqrt and **2: 2.0000000066771721
25 times sqrt and **2: 2.0000000066771721
26 times sqrt and **2: 1.9999999917775542
27 times sqrt and **2: 1.9999999917775542
28 times sqrt and **2: 1.9999999917775542
29 times sqrt and **2: 1.9999999917775542
30 times sqrt and **2: 1.9999999917775542
31 times sqrt and **2: 1.9999999917775542
32 times sqrt and **2: 1.9999990380770896
33 times sqrt and **2: 1.9999971307544144
34 times sqrt and **2: 1.9999971307544144
35 times sqrt and **2: 1.9999971307544144
36 times sqrt and **2: 1.9999971307544144
37 times sqrt and **2: 1.9999971307544144
38 times sqrt and **2: 1.9999360966436217
39 times sqrt and **2: 1.9999360966436217
40 times sqrt and **2: 1.9999360966436217
41 times sqrt and **2: 1.9994478907329654
42 times sqrt and **2: 1.9984718365144798
43 times sqrt and **2: 1.9965211562778555
44 times sqrt and **2: 1.9965211562778555
45 times sqrt and **2: 1.9887374575497223
46 times sqrt and **2: 1.9887374575497223
47 times sqrt and **2: 1.9887374575497223
48 times sqrt and **2: 1.9887374575497223
49 times sqrt and **2: 1.8682459487159784
50 times sqrt and **2: 1.6487212645509468
51 times sqrt and **2: 1.6487212645509468
52 times sqrt and **2: 1.0000000000000000
53 times sqrt and **2: 1.0000000000000000
54 times sqrt and **2: 1.0000000000000000
55 times sqrt and **2: 1.0000000000000000
56 times sqrt and **2: 1.0000000000000000
57 times sqrt and **2: 1.0000000000000000
58 times sqrt and **2: 1.0000000000000000
59 times sqrt and **2: 1.0000000000000000
SQUARE ROOT
2.0000000000000000000000000000000000000000
1.4142135623730951454746218587388284504414
1.1892071150027210268973476559040136635303
1.0905077326652576896748314538854174315929
1.0442737824274137548030694233602844178677
1.0218971486541166271422298450488597154617
1.0108892860517004752551883939304389059544
1.0054299011128027263595186013844795525074
1.0027112750502025217969048753730021417141
1.0013547198921082248546099435770884156227
1.0006771306930664078294057617313228547573
1.0003385080526823180946394131751731038094
1.0001692397053021377217874032794497907162
1.0000846162726941823706283685169182717800
1.0000423072413957559234631844446994364262
1.0000211533969647348385478835552930831909
1.0000105766425497755278684053337201476097
1.0000052883072918508133852810715325176716
1.0000026441501501661690554101369343698025
1.0000013220742012265418452443554997444153
1.0000006610368821213796763913705945014954
1.0000003305183864377170266379835084080696
1.0000001652591796741376128920819610357285
1.0000000826295865063997325705713592469692
1.0000000413147924760437490476761013269424
1.0000000206573960159772695988067425787449
1.0000000103286978969663323368877172470093
1.0000000051643489484831661684438586235046
1.0000000025821744742415830842219293117523
1.0000000012910872371207915421109646558762
1.0000000006455436185603957710554823279381
1.0000000003227718092801978855277411639690
1.0000000001613857936177964802482165396214
1.0000000000806927857865957776084542274475
1.0000000000403463928932978888042271137238
1.0000000000201731964466489444021135568619
1.0000000000100865982233244722010567784309
1.0000000000050432991116622361005283892155
1.0000000000025215385335286555346101522446
1.0000000000012607692667643277673050761223
1.0000000000006303846333821638836525380611
1.0000000000003150812943886194261722266674
1.0000000000001574296248918471974320709705
1.0000000000000786037901434610830619931221
1.0000000000000393018950717305415309965611
1.0000000000000195399252334027551114559174
1.0000000000000097699626167013775557279587
1.0000000000000048849813083506887778639793
1.0000000000000024424906541753443889319897
1.0000000000000011102230246251565404236317
1.0000000000000004440892098500626161694527
1.0000000000000002220446049250313080847263
1.0000000000000000000000000000000000000000
1.0000000000000000000000000000000000000000
POWER OF 2
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
1.0000000000000000
54 times sqrt and **2: 1.0000000000000000
"""

"""
Explain with words what the program does. Then run the program. Round-off
errors are here completely destroying the calculations when n is large enough! In-
vestigate the case when we come back to 1 instead of 2 by fixing an n value where
this happens and printing out r in both for loops over i . Can you now explain why
we come back to 1 and not 2?
"""

from math import sqrt

for n in range(1, 60):
    r = 2.0
    for i in range(n):
        r = sqrt(r)
    for i in range(n):
        r = r**2
    print('%d times sqrt and **2: %.16f' % (n, r))

# THIS PROGRAM COMPUTES THE SQUARE ROOT OF A NUMBER n TIMES, AND TRIES TO OBTAIN BACK
# THE ORIGINAL NUMBER BY ELEVATING TO THE POWER OF 2 n TIMES.

r = 2.0
n = 0
print("SQUARE ROOT")
while n < 54:
    print("{:.40f}".format(r))
    r = sqrt(r)
    n += 1

n = 0
print("POWER OF 2")
while n < 54:
    print("{:.16f}".format(r))
    r = r**2
    n += 1

print('%d times sqrt and **2: %.16f' % (n, r))

# THE PROGRAM DOES NOT WORK BECAUSE PYTHON ONLY SAVES 15 DIGITS BEHIND THE COMMA, SO AFTER
# A CERTAIN AMOUNT OF CYCLES THE SQUARE ROOT OF TWO BECOMES ONLY ONE.